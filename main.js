(()=>{"use strict";const t=(()=>{const t=document.querySelector(".P1"),e=document.querySelector(".P2"),a=()=>{e.classList.add("active")};return a(),{init:a,renderGameboard:(a,s,i)=>{const r="P1"===a?t:e;r.classList.add(s),i.forEach((t=>r.appendChild((t=>{const e=document.createElement("div");return e.classList.add("cell"),e.setAttribute("data-coords",`${t.coords.x} ${t.coords.y}`),t.hasShip&&e.classList.add("ship"),(t=>{t.addEventListener("click",(()=>{const e=t.getAttribute("data-coords").split(" "),a={x:+e[0],y:+e[1]};o.playTurn(a)}))})(e),e})(t))))},cellHit:t=>{const e=`${t.x} ${t.y}`;document.querySelector(`.active > [data-coords="${e}"]`).classList.add("hit")},shipSunk:t=>{t.forEach((t=>{document.querySelector(`.active > [data-coords="${t.x} ${t.y}"]`).classList.add("sunk")}))},toggleActiveBoard:()=>{t.classList.toggle("active"),e.classList.toggle("active")}}})(),e=e=>{const a=[],s=(t=>{const e=[];for(let a=0;a<t*t;a++)e.push({coords:{x:a%t,y:Math.floor(a/t)},hasShip:"",isShot:!1});return e})(e),i=t=>s[t.x+t.y*e];return{at:i,isValidAttack:t=>!i(t).isShot,isShipHit:t=>""!==i(t).hasShip,receiveAttack:e=>{const o=i(e);if(o.isShot=!0,t.cellHit(e),o.hasShip){const e=a.find((t=>t.name===o.hasShip));e.hit(),e.isSunk()&&(e=>{console.log(e);const a=s.filter((t=>t.hasShip===e)).map((t=>t.coords));t.shipSunk(a)})(e.name)}},setShip:(t,e,s="x")=>{a.push(t);let o=e;for(let e=0;e<t.getLength();e++)i(o).hasShip=t.name,"x"===s?o.x++:o.y++},getBoard:()=>s}},a=t=>({name:t,gameboard:e(10),isActive:!1}),s=(t,e)=>{const a=t;let s=0;return{name:e,getLength:()=>a,getHits:()=>s,hit:()=>{s++},isSunk:()=>a===s}},i=t=>{const e=t.filter((t=>!t.isShot));return e[Math.floor(Math.random()*e.length)].coords},o=(()=>{const e=a("player"),o=a("enemy"),r=()=>e.isActive?o:e,c=a=>{const s=r().gameboard;d(s,a),s.isShipHit(a)||(e.isActive=!e.isActive,o.isActive=!o.isActive,t.toggleActiveBoard()),n()},n=async()=>{o.isActive&&(await(300,new Promise((t=>setTimeout(t,300)))),c(i(r().gameboard.getBoard())))},d=(t,e)=>{t.isValidAttack(e)&&t.receiveAttack(e)};return{init:()=>{(()=>{e.isActive=!0;let a=[s(4,"ak"),s(2,"b")];e.gameboard.setShip(a[0],{x:1,y:2},"x"),e.gameboard.setShip(a[1],{x:2,y:5},"y"),t.renderGameboard("P1",e.name,e.gameboard.getBoard())})(),(()=>{o.isActive=!1;let e=[s(3,"enemya"),s(2,"enemyb")];o.gameboard.setShip(e[0],{x:1,y:1},"x"),o.gameboard.setShip(e[1],{x:2,y:5},"y"),t.renderGameboard("P2",o.name,o.gameboard.getBoard())})()},fireAttack:d,playTurn:c}})();o.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUXRCLEVBQU0sR0FBSSxDQUFDZixFQUFHLEVBQUdDLEVBQUcsR0FBSSxLQUNsRGlELEVBQVFSLFVBQVVMLFFBQVF0QixFQUFNLEdBQUksQ0FBQ2YsRUFBRyxFQUFHQyxFQUFHLEdBQUksS0FDbEQsa0JBQW1CLEtBQU1pRCxFQUFRckIsS0FBTXFCLEVBQVFSLFVBQVVELGFBK0J6RG9CLEdBNUJrQixNQUNsQlYsRUFBUVIsVUFBVyxFQUNuQixJQUFJNUIsRUFBUSxDQUFDLEVBQUssRUFBRyxVQUFXLEVBQUssRUFBRyxXQUN4Q29DLEVBQVFULFVBQVVMLFFBQVF0QixFQUFNLEdBQUksQ0FBQ2YsRUFBRyxFQUFHQyxFQUFHLEdBQUksS0FDbERrRCxFQUFRVCxVQUFVTCxRQUFRdEIsRUFBTSxHQUFJLENBQUNmLEVBQUcsRUFBR0MsRUFBRyxHQUFJLEtBQ2xELGtCQUFtQixLQUFNa0QsRUFBUXRCLEtBQU1zQixFQUFRVCxVQUFVRCxhQXdCekRxQixJQUtBUCxXQUFBQSxFQUNBRixTQUFBQSxJQWxFbUIsR0NIdkIsVSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvTW9kdWxlcy9VSS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL0ZhY3Rvcmllcy9HYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9GYWN0b3JpZXMvUGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvRmFjdG9yaWVzL1NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9Nb2R1bGVzL0FJUGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvTW9kdWxlcy9HYW1lQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBHYW1lQ29udHJvbGxlciBmcm9tIFwiLi9HYW1lQ29udHJvbGxlclwiO1xuXG5cbmNvbnN0IFVJID0gKCgpID0+IHtcbiAgY29uc3QgJHAxR2FtZWJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLlAxJyk7XG4gIGNvbnN0ICRwMkdhbWVib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5QMicpO1xuICBcbiAgY29uc3QgbmV3Q2VsbERPTSA9IChjZWxsKSA9PiB7XG4gICAgICBjb25zdCAkY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgJGNlbGwuY2xhc3NMaXN0LmFkZCgnY2VsbCcpO1xuICAgICAgJGNlbGwuc2V0QXR0cmlidXRlKCdkYXRhLWNvb3JkcycsIGAke2NlbGwuY29vcmRzLnh9ICR7Y2VsbC5jb29yZHMueX1gKTtcbiAgICAgIGlmIChjZWxsLmhhc1NoaXApICRjZWxsLmNsYXNzTGlzdC5hZGQoJ3NoaXAnKTtcbiAgICAgIGFkZENlbGxMaXN0ZW5lcigkY2VsbCk7XG4gICAgICByZXR1cm4gJGNlbGw7XG4gIH1cblxuICBjb25zdCBhZGRDZWxsTGlzdGVuZXIgPSAoJGNlbGwpID0+IHtcbiAgICAkY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvb3Jkc0FycmF5ID0gJGNlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLWNvb3JkcycpLnNwbGl0KCcgJyk7XG4gICAgICBjb25zdCBjb29yZHMgPSB7eDogK2Nvb3Jkc0FycmF5WzBdLCB5OiArY29vcmRzQXJyYXlbMV19O1xuICAgICAgR2FtZUNvbnRyb2xsZXIucGxheVR1cm4oY29vcmRzKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGNlbGxIaXQgPSAoY29vcmRzKSA9PiB7XG4gICAgY29uc3QgZW5jb2RlZENvb3JkcyA9IGAke2Nvb3Jkcy54fSAke2Nvb3Jkcy55fWA7XG4gICAgY29uc3QgJGNlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYWN0aXZlID4gW2RhdGEtY29vcmRzPVwiJHtlbmNvZGVkQ29vcmRzfVwiXWApO1xuICAgICRjZWxsLmNsYXNzTGlzdC5hZGQoJ2hpdCcpO1xuICB9XG5cbiAgY29uc3QgdG9nZ2xlQWN0aXZlQm9hcmQgPSAoKSA9PiB7XG4gICAgJHAxR2FtZWJvYXJkLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xuICAgICRwMkdhbWVib2FyZC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgfVxuXG4gIGNvbnN0IHNoaXBTdW5rID0gKGNvb3Jkc0FycmF5KSA9PiB7XG4gICAgY29vcmRzQXJyYXkuZm9yRWFjaChjb29yZHMgPT4ge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmFjdGl2ZSA+IFtkYXRhLWNvb3Jkcz1cIiR7Y29vcmRzLnh9ICR7Y29vcmRzLnl9XCJdYCkuY2xhc3NMaXN0LmFkZCgnc3VuaycpO1xuICAgIH0pXG4gIH1cblxuICBjb25zdCByZW5kZXJHYW1lYm9hcmQgPSAocGxheWVyLCBwbGF5ZXJOYW1lLCBib2FyZCkgPT4ge1xuICAgIGNvbnN0ICRib2FyZCA9IHBsYXllciA9PT0gJ1AxJyA/ICRwMUdhbWVib2FyZCA6ICRwMkdhbWVib2FyZDtcbiAgICAkYm9hcmQuY2xhc3NMaXN0LmFkZChwbGF5ZXJOYW1lKTtcbiAgICBib2FyZC5mb3JFYWNoKGNlbGwgPT4gJGJvYXJkLmFwcGVuZENoaWxkKG5ld0NlbGxET00oY2VsbCkpKTtcbiAgfVxuXG4gIGNvbnN0IGluaXQgPSAoKSA9PiB7XG4gICAgJHAyR2FtZWJvYXJkLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICB9XG5cbiAgaW5pdCgpO1xuXG4gIHJldHVybiB7XG4gICAgaW5pdCxcbiAgICByZW5kZXJHYW1lYm9hcmQsXG4gICAgY2VsbEhpdCxcbiAgICBzaGlwU3VuayxcbiAgICB0b2dnbGVBY3RpdmVCb2FyZCxcbiAgfTtcblxufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgVUk7IiwiaW1wb3J0IFVJIGZyb20gXCIuLi9Nb2R1bGVzL1VJXCI7XG5cbmNvbnN0IEdhbWVib2FyZCA9IChzaXplKSA9PiB7XG5cbiAgY29uc3Qgc2hpcHMgPSBbXTtcblxuICBjb25zdCBjZWxsID0gKHgsIHkpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgY29vcmRzOiB7eCwgeX0sXG4gICAgICBoYXNTaGlwOiAnJyxcbiAgICAgIGlzU2hvdDogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgX21ha2VHcmlkID0gKHNpemUpID0+IHtcbiAgICBjb25zdCBhcnIgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemUgKiBzaXplOyBpKyspIHtcbiAgICAgIGFyci5wdXNoKGNlbGwoaSAlIHNpemUsIE1hdGguZmxvb3IoaSAvIHNpemUpKSk7XG4gICAgfVxuICAgIHJldHVybiBhcnI7XG4gIH1cblxuICBjb25zdCBib2FyZCA9IF9tYWtlR3JpZChzaXplKTtcbiAgY29uc3QgYXQgPSAoY29vcmRzKSA9PiBib2FyZFtjb29yZHMueCArIGNvb3Jkcy55ICogc2l6ZV07XG5cbiAgY29uc3QgaXNWYWxpZEF0dGFjayA9IChjb29yZHMpID0+IHtcbiAgICByZXR1cm4gIWF0KGNvb3JkcykuaXNTaG90O1xuICB9XG5cbiAgY29uc3QgaXNTaGlwSGl0ID0gKGNvb3JkcykgPT4ge1xuICAgIHJldHVybiBhdChjb29yZHMpLmhhc1NoaXAgIT09ICcnO1xuICB9XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb29yZHMpID0+IHtcbiAgICBjb25zdCBjZWxsID0gYXQoY29vcmRzKTtcbiAgICBjZWxsLmlzU2hvdCA9IHRydWU7XG4gICAgVUkuY2VsbEhpdChjb29yZHMpO1xuICAgIGlmIChjZWxsLmhhc1NoaXApIHtcbiAgICAgIGNvbnN0IHNoaXAgPSBzaGlwcy5maW5kKHNoaXAgPT4gc2hpcC5uYW1lID09PSBjZWxsLmhhc1NoaXApO1xuICAgICAgc2hpcC5oaXQoKTtcbiAgICAgIGlmIChzaGlwLmlzU3VuaygpKSBzaGlwU3VuayhzaGlwLm5hbWUpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHNldFNoaXAgPSAoc2hpcCwgY29vcmRzLCBheGlzID0gJ3gnKSA9PiB7XG4gICAgc2hpcHMucHVzaChzaGlwKTtcbiAgICBsZXQgbmV3Q29vcmRzID0gY29vcmRzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5nZXRMZW5ndGgoKTsgaSsrKSB7XG4gICAgICBhdChuZXdDb29yZHMpLmhhc1NoaXAgPSBzaGlwLm5hbWU7XG4gICAgICBheGlzID09PSAneCcgPyBuZXdDb29yZHMueCsrOiBuZXdDb29yZHMueSsrO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHNoaXBTdW5rID0gKHNoaXBOYW1lKSA9PiB7XG4gICAgY29uc29sZS5sb2coc2hpcE5hbWUpO1xuICAgIGNvbnN0IGNvb3Jkc0FycmF5ID0gYm9hcmQuZmlsdGVyKGNlbGwgPT4gY2VsbC5oYXNTaGlwID09PSBzaGlwTmFtZSkubWFwKGNlbGwgPT4gY2VsbC5jb29yZHMpO1xuICAgIFVJLnNoaXBTdW5rKGNvb3Jkc0FycmF5KTtcbiAgfVxuXG4gIGNvbnN0IGdldEJvYXJkID0gKCkgPT4gYm9hcmQ7XG5cbiAgcmV0dXJuIHtcbiAgICBhdCxcbiAgICBpc1ZhbGlkQXR0YWNrLFxuICAgIGlzU2hpcEhpdCxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIHNldFNoaXAsXG4gICAgZ2V0Qm9hcmQsXG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IEdhbWVib2FyZDsiLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL0dhbWVib2FyZFwiXG5cbmNvbnN0IFBsYXllciA9IChuYW1lKSA9PiB7XG4gIHJldHVybiB7XG4gICAgbmFtZSxcbiAgICBnYW1lYm9hcmQ6IEdhbWVib2FyZCgxMCksXG4gICAgaXNBY3RpdmU6IGZhbHNlLFxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBQbGF5ZXI7IiwiY29uc3QgU2hpcCA9IChsZW5ndGgsIG5hbWUpID0+IHtcbiAgY29uc3Qgc2hpcExlbmd0aCA9IGxlbmd0aDtcbiAgbGV0IGhpdENvdW50ID0gMDtcblxuICAvLyBHZXR0ZXJzXG4gIGNvbnN0IGdldExlbmd0aCA9ICgpID0+IHNoaXBMZW5ndGg7XG4gIGNvbnN0IGdldEhpdHMgPSAoKSA9PiBoaXRDb3VudDtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgaGl0Q291bnQrKztcbiAgfVxuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gc2hpcExlbmd0aCA9PT0gaGl0Q291bnQ7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG5hbWUsXG4gICAgZ2V0TGVuZ3RoLFxuICAgIGdldEhpdHMsXG4gICAgaGl0LFxuICAgIGlzU3VuayxcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgU2hpcDsiLCJjb25zdCBBSSA9ICgoKSA9PiB7XG5cbiAgY29uc3QgZ2V0Q29vcmRzID0gKGJvYXJkKSA9PiB7XG4gICAgY29uc3QgdmFsaWRDZWxscyA9IGJvYXJkLmZpbHRlcihjZWxsID0+ICFjZWxsLmlzU2hvdCk7XG4gICAgY29uc3QgY29vcmRzID0gdmFsaWRDZWxsc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB2YWxpZENlbGxzLmxlbmd0aCldLmNvb3JkcztcbiAgICByZXR1cm4gY29vcmRzO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgZ2V0Q29vcmRzLFxuICB9O1xuXG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBBSTsiLCJpbXBvcnQgUGxheWVyIGZyb20gXCIuLi9GYWN0b3JpZXMvUGxheWVyXCJcbmltcG9ydCBTaGlwIGZyb20gXCIuLi9GYWN0b3JpZXMvU2hpcFwiO1xuaW1wb3J0IFVJIGZyb20gXCIuL1VJXCI7XG5pbXBvcnQgQUkgZnJvbSBcIi4vQUlQbGF5ZXJcIjtcblxuY29uc3QgR2FtZUNvbnRyb2xsZXIgPSAoKCkgPT4ge1xuXG4gIGNvbnN0IHBsYXllcjEgPSBQbGF5ZXIoJ3BsYXllcicpO1xuICBjb25zdCBwbGF5ZXIyID0gUGxheWVyKCdlbmVteScpO1xuXG4gIGZ1bmN0aW9uIHNsZWVwKG1zKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuICB9IFxuXG4gIC8vIGNvbnN0IGFjdGl2ZVBsYXllciA9ICgpID0+IHtcbiAgLy8gICByZXR1cm4gcGxheWVyMS5pc0FjdGl2ZSA/IHBsYXllcjE6IHBsYXllcjI7XG4gIC8vIH1cblxuICBjb25zdCBvcHBvbmVudCA9ICgpID0+IHtcbiAgICByZXR1cm4gcGxheWVyMS5pc0FjdGl2ZSA/IHBsYXllcjI6IHBsYXllcjE7XG4gIH1cblxuICBjb25zdCB0b2dnbGVBY3RpdmVQbGF5ZXIgPSAoKSA9PiB7XG4gICAgcGxheWVyMS5pc0FjdGl2ZSA9ICFwbGF5ZXIxLmlzQWN0aXZlO1xuICAgIHBsYXllcjIuaXNBY3RpdmUgPSAhcGxheWVyMi5pc0FjdGl2ZTtcbiAgICBVSS50b2dnbGVBY3RpdmVCb2FyZCgpO1xuICB9XG5cbiAgY29uc3QgaW5pdFBsYXllcjEgPSAoKSA9PiB7XG4gICAgcGxheWVyMS5pc0FjdGl2ZSA9IHRydWU7XG4gICAgbGV0IHNoaXBzID0gW1NoaXAoNCwgJ2FrJyksIFNoaXAoMiwgJ2InKV07XG4gICAgcGxheWVyMS5nYW1lYm9hcmQuc2V0U2hpcChzaGlwc1swXSwge3g6IDEsIHk6IDJ9LCAneCcpO1xuICAgIHBsYXllcjEuZ2FtZWJvYXJkLnNldFNoaXAoc2hpcHNbMV0sIHt4OiAyLCB5OiA1fSwgJ3knKTtcbiAgICBVSS5yZW5kZXJHYW1lYm9hcmQoJ1AxJywgcGxheWVyMS5uYW1lLCBwbGF5ZXIxLmdhbWVib2FyZC5nZXRCb2FyZCgpKTtcbiAgfVxuXG4gIGNvbnN0IGluaXRQbGF5ZXIyID0gKCkgPT4ge1xuICAgIHBsYXllcjIuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICBsZXQgc2hpcHMgPSBbU2hpcCgzLCAnZW5lbXlhJyksIFNoaXAoMiwgJ2VuZW15YicpXTtcbiAgICBwbGF5ZXIyLmdhbWVib2FyZC5zZXRTaGlwKHNoaXBzWzBdLCB7eDogMSwgeTogMX0sICd4Jyk7XG4gICAgcGxheWVyMi5nYW1lYm9hcmQuc2V0U2hpcChzaGlwc1sxXSwge3g6IDIsIHk6IDV9LCAneScpO1xuICAgIFVJLnJlbmRlckdhbWVib2FyZCgnUDInLCBwbGF5ZXIyLm5hbWUsIHBsYXllcjIuZ2FtZWJvYXJkLmdldEJvYXJkKCkpO1xuICB9XG5cbiAgY29uc3QgcGxheVR1cm4gPSAoY29vcmRzKSA9PiB7XG4gICAgY29uc3Qgb3Bwb25lbnRCb2FyZCA9IG9wcG9uZW50KCkuZ2FtZWJvYXJkO1xuICAgIGZpcmVBdHRhY2sob3Bwb25lbnRCb2FyZCwgY29vcmRzKTtcbiAgICBpZiAoIW9wcG9uZW50Qm9hcmQuaXNTaGlwSGl0KGNvb3JkcykpIHRvZ2dsZUFjdGl2ZVBsYXllcigpO1xuICAgIHBsYXlHYW1lKCk7XG4gIH1cblxuICBjb25zdCBwbGF5R2FtZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAocGxheWVyMi5pc0FjdGl2ZSkge1xuICAgICAgYXdhaXQgc2xlZXAoMzAwKTtcbiAgICAgIHBsYXlUdXJuKEFJLmdldENvb3JkcyhvcHBvbmVudCgpLmdhbWVib2FyZC5nZXRCb2FyZCgpKSk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgZmlyZUF0dGFjayA9IChib2FyZCwgY29vcmRzKSA9PiB7XG4gICAgaWYgKCFib2FyZC5pc1ZhbGlkQXR0YWNrKGNvb3JkcykpIHJldHVybjtcbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3Jkcyk7XG4gIH1cblxuICBjb25zdCBpbml0ID0gKCkgPT4ge1xuICAgIGluaXRQbGF5ZXIxKCk7XG4gICAgaW5pdFBsYXllcjIoKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQsXG4gICAgZmlyZUF0dGFjayxcbiAgICBwbGF5VHVybixcbiAgfTtcblxufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgR2FtZUNvbnRyb2xsZXI7IiwiaW1wb3J0IEdhbWVDb250cm9sbGVyIGZyb20gXCIuL01vZHVsZXMvR2FtZUNvbnRyb2xsZXJcIjtcblxuR2FtZUNvbnRyb2xsZXIuaW5pdCgpOyJdLCJuYW1lcyI6WyIkcDFHYW1lYm9hcmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCIkcDJHYW1lYm9hcmQiLCJpbml0IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVuZGVyR2FtZWJvYXJkIiwicGxheWVyIiwicGxheWVyTmFtZSIsImJvYXJkIiwiJGJvYXJkIiwiZm9yRWFjaCIsImNlbGwiLCJhcHBlbmRDaGlsZCIsIiRjZWxsIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImNvb3JkcyIsIngiLCJ5IiwiaGFzU2hpcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb29yZHNBcnJheSIsImdldEF0dHJpYnV0ZSIsInNwbGl0IiwiYWRkQ2VsbExpc3RlbmVyIiwibmV3Q2VsbERPTSIsImNlbGxIaXQiLCJlbmNvZGVkQ29vcmRzIiwic2hpcFN1bmsiLCJ0b2dnbGVBY3RpdmVCb2FyZCIsInRvZ2dsZSIsInNpemUiLCJzaGlwcyIsImFyciIsImkiLCJwdXNoIiwiTWF0aCIsImZsb29yIiwiaXNTaG90IiwiX21ha2VHcmlkIiwiYXQiLCJpc1ZhbGlkQXR0YWNrIiwiaXNTaGlwSGl0IiwicmVjZWl2ZUF0dGFjayIsInNoaXAiLCJmaW5kIiwibmFtZSIsImhpdCIsImlzU3VuayIsInNoaXBOYW1lIiwiY29uc29sZSIsImxvZyIsImZpbHRlciIsIm1hcCIsInNldFNoaXAiLCJheGlzIiwibmV3Q29vcmRzIiwiZ2V0TGVuZ3RoIiwiZ2V0Qm9hcmQiLCJnYW1lYm9hcmQiLCJpc0FjdGl2ZSIsImxlbmd0aCIsInNoaXBMZW5ndGgiLCJoaXRDb3VudCIsImdldEhpdHMiLCJ2YWxpZENlbGxzIiwicmFuZG9tIiwicGxheWVyMSIsInBsYXllcjIiLCJvcHBvbmVudCIsInBsYXlUdXJuIiwib3Bwb25lbnRCb2FyZCIsImZpcmVBdHRhY2siLCJwbGF5R2FtZSIsImFzeW5jIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiaW5pdFBsYXllcjEiLCJpbml0UGxheWVyMiJdLCJzb3VyY2VSb290IjoiIn0=