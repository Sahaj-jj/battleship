(()=>{"use strict";const t=(()=>{const t=document.querySelector(".P1"),e=document.querySelector(".P2"),s=()=>{e.classList.add("active")};return s(),{init:s,renderGameboard:(s,a,o)=>{let i="P1"===s?t:e;i.classList.add(a),o.forEach((t=>i.appendChild((t=>{const e=document.createElement("div");return e.classList.add("cell"),e.setAttribute("data-coords",`${t.coords.x} ${t.coords.y}`),t.hasShip&&e.classList.add("ship"),(t=>{t.addEventListener("click",(()=>{const e=t.getAttribute("data-coords").split(" "),s={x:+e[0],y:+e[1]};r.playTurn(s)}))})(e),e})(t))))},cellHit:t=>{const e=`${t.x} ${t.y}`;document.querySelector(`.active > [data-coords="${e}"]`).classList.add("hit")},shipSunk:t=>{t.forEach((t=>{document.querySelector(`.active > [data-coords="${t.x} ${t.y}"]`).classList.add("sunk")}))},toggleActiveBoard:()=>{t.classList.toggle("active"),e.classList.toggle("active")}}})(),e=e=>{const s=[],a=(t=>{const e=[];for(let s=0;s<t*t;s++)e.push({coords:{x:s%t,y:Math.floor(s/t)},hasShip:"",isShot:!1});return e})(e),o=t=>a[t.x+t.y*e];return{at:o,isValidAttack:t=>!o(t).isShot,isShipHit:t=>""!==o(t).hasShip,receiveAttack:e=>{const r=o(e);if(r.isShot=!0,t.cellHit(e),r.hasShip){const e=s.find((t=>t.name===r.hasShip));e.hit(),e.isSunk()&&(e=>{console.log(e);const s=a.filter((t=>t.hasShip===e)).map((t=>t.coords));t.shipSunk(s)})(e.name)}},setShip:(t,e,a="x")=>{s.push(t);let r=e;for(let e=0;e<t.getLength();e++)o(r).hasShip=t.name,"x"===a?r.x++:r.y++},getBoard:()=>a}},s=t=>({name:t,gameboard:e(10),isActive:!1}),a=(t,e)=>{const s=t;let a=0;return{name:e,getLength:()=>s,getHits:()=>a,hit:()=>{a++},isSunk:()=>s===a}},o=t=>{const e=t.filter((t=>!t.isShot));return e[Math.floor(Math.random()*e.length)].coords},r=(()=>{const e=s("player"),r=s("enemy"),c=()=>e.isActive?r:e,d=s=>{const a=c().gameboard;a.isValidAttack(s)&&(a.receiveAttack(s),a.isShipHit(s)||(e.isActive=!e.isActive,r.isActive=!r.isActive,t.toggleActiveBoard()),n())},n=async()=>{r.isActive&&(await(300,new Promise((t=>setTimeout(t,300)))),d(o(c().gameboard.getBoard())))};return{init:()=>{e.isActive=!0,i.getShipInfoArray().forEach((t=>{e.gameboard.setShip(t.ship,t.coords,t.axis)})),t.renderGameboard("P1",e.name,e.gameboard.getBoard()),(()=>{r.isActive=!1;let e=[a(3,"enemya"),a(2,"enemyb")];r.gameboard.setShip(e[0],{x:1,y:1},"x"),r.gameboard.setShip(e[1],{x:2,y:5},"y"),t.renderGameboard("P2",r.name,r.gameboard.getBoard())})()},playTurn:d}})(),i=(()=>{const t=s("sample"),e=[a(4,"ak"),a(2,"b"),a(5,"c"),a(4,"d"),a(2,"e")];let o={shipNum:0,shipCoordsArray:[],axis:"x"};const i=document.querySelector(".modal"),c=document.querySelector(".sample"),d=[],n=(t,s)=>{0!==o.shipCoordsArray.length&&o.shipCoordsArray.forEach((t=>{document.querySelector(`.board > [data-coords="${t.x} ${t.y}"]`).classList.remove("temp")})),o.shipCoordsArray=[];let a=t;for(let t=0;t<e[o.shipNum].getLength()&&(o.shipCoordsArray.push({x:a.x,y:a.y}),document.querySelector(`.board > [data-coords="${a.x} ${a.y}"]`).classList.add("temp"),"x"===s?a.x++:a.y++,!(a.x>9||a.y>9));t++);},l=(t,e,s)=>{let a=c;a.classList.add(e),s.forEach((t=>a.appendChild((t=>{const e=document.createElement("div");return e.classList.add("cell"),e.setAttribute("data-coords",`${t.coords.x} ${t.coords.y}`),(t=>{t.addEventListener("click",(()=>{const e=t.getAttribute("data-coords").split(" "),s={x:+e[0],y:+e[1]};h(s,o.axis)})),t.addEventListener("mouseover",(()=>{const e=t.getAttribute("data-coords").split(" "),s={x:+e[0],y:+e[1]};n(s,o.axis)}))})(e),e})(t))))},h=(t,s)=>{d.push(((t,e,s)=>({ship:t,coords:e,axis:s}))(e[o.shipNum++],t,s)),o.shipCoordsArray.forEach((t=>{const e=document.querySelector(`.board > [data-coords="${t.x} ${t.y}"]`);e.classList.add("ship"),e.classList.remove("temp")})),d.length===e.length&&(i.remove(),r.init())};return{init:()=>{l(0,t.name,t.gameboard.getBoard()),document.addEventListener("keyup",(({key:t})=>{"R"!==t&&"r"!==t||(o.axis="x"===o.axis?"y":"x",n(o.shipCoordsArray[0],o.axis))}))},getShipInfoArray:()=>d}})();i.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0UsT0FDbEZMLEVBQU1WLFVBQVVDLElBQUksUUFDcEJTLEVBQU1WLFVBQVVtRixPQUFPLFdBRXJCRixFQUFjdkIsU0FBVzdCLEVBQU02QixTQUNqQ3FCLEVBQU9JLFNBQ1AsV0FnQkosTUFBTyxDQUNMcEYsS0FYVyxLQUNYRyxFQUFnQixFQUFVQyxFQUFPd0MsS0FBTXhDLEVBQU9xRCxVQUFVRCxZQUN4RDNELFNBQVNxQixpQkFBaUIsU0FBUyxFQUFHb0UsSUFBQUEsTUFDeEIsTUFBUkEsR0FBdUIsTUFBUkEsSUFDakJULEVBQVF4QixLQUF3QixNQUFqQndCLEVBQVF4QixLQUFlLElBQUssSUFDM0M4QixFQUFTTixFQUFRRSxnQkFBZ0IsR0FBSUYsRUFBUXhCLFdBT2pEa0MsaUJBZHVCLElBQU1MLElBaEZkLEdDRG5CLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL01vZHVsZXMvVUkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9GYWN0b3JpZXMvR2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvRmFjdG9yaWVzL1BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL0ZhY3Rvcmllcy9TaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvTW9kdWxlcy9BSVBsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL01vZHVsZXMvR2FtZUNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9Nb2R1bGVzL1BsYWNlU2hpcHMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgR2FtZUNvbnRyb2xsZXIgZnJvbSBcIi4vR2FtZUNvbnRyb2xsZXJcIjtcblxuXG5jb25zdCBVSSA9ICgoKSA9PiB7XG4gIGNvbnN0ICRwMUdhbWVib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5QMScpO1xuICBjb25zdCAkcDJHYW1lYm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuUDInKTtcbiAgXG4gIGNvbnN0IG5ld0NlbGxET00gPSAoY2VsbCkgPT4ge1xuICAgICAgY29uc3QgJGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICRjZWxsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcbiAgICAgICRjZWxsLnNldEF0dHJpYnV0ZSgnZGF0YS1jb29yZHMnLCBgJHtjZWxsLmNvb3Jkcy54fSAke2NlbGwuY29vcmRzLnl9YCk7XG4gICAgICBpZiAoY2VsbC5oYXNTaGlwKSAkY2VsbC5jbGFzc0xpc3QuYWRkKCdzaGlwJyk7XG4gICAgICBhZGRDZWxsTGlzdGVuZXIoJGNlbGwpO1xuICAgICAgcmV0dXJuICRjZWxsO1xuICB9XG5cbiAgY29uc3QgYWRkQ2VsbExpc3RlbmVyID0gKCRjZWxsKSA9PiB7XG4gICAgJGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb29yZHNBcnJheSA9ICRjZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1jb29yZHMnKS5zcGxpdCgnICcpO1xuICAgICAgY29uc3QgY29vcmRzID0ge3g6ICtjb29yZHNBcnJheVswXSwgeTogK2Nvb3Jkc0FycmF5WzFdfTtcbiAgICAgIEdhbWVDb250cm9sbGVyLnBsYXlUdXJuKGNvb3Jkcyk7XG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBjZWxsSGl0ID0gKGNvb3JkcykgPT4ge1xuICAgIGNvbnN0IGVuY29kZWRDb29yZHMgPSBgJHtjb29yZHMueH0gJHtjb29yZHMueX1gO1xuICAgIGNvbnN0ICRjZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmFjdGl2ZSA+IFtkYXRhLWNvb3Jkcz1cIiR7ZW5jb2RlZENvb3Jkc31cIl1gKTtcbiAgICAkY2VsbC5jbGFzc0xpc3QuYWRkKCdoaXQnKTtcbiAgfVxuXG4gIGNvbnN0IHRvZ2dsZUFjdGl2ZUJvYXJkID0gKCkgPT4ge1xuICAgICRwMUdhbWVib2FyZC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgICAkcDJHYW1lYm9hcmQuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gIH1cblxuICBjb25zdCBzaGlwU3VuayA9IChjb29yZHNBcnJheSkgPT4ge1xuICAgIGNvb3Jkc0FycmF5LmZvckVhY2goY29vcmRzID0+IHtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5hY3RpdmUgPiBbZGF0YS1jb29yZHM9XCIke2Nvb3Jkcy54fSAke2Nvb3Jkcy55fVwiXWApLmNsYXNzTGlzdC5hZGQoJ3N1bmsnKTtcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgcmVuZGVyR2FtZWJvYXJkID0gKHBsYXllciwgcGxheWVyTmFtZSwgYm9hcmQpID0+IHtcbiAgICBsZXQgJGJvYXJkID0gcGxheWVyID09PSAnUDEnID8gJHAxR2FtZWJvYXJkIDogJHAyR2FtZWJvYXJkO1xuICAgICRib2FyZC5jbGFzc0xpc3QuYWRkKHBsYXllck5hbWUpO1xuICAgIGJvYXJkLmZvckVhY2goY2VsbCA9PiAkYm9hcmQuYXBwZW5kQ2hpbGQobmV3Q2VsbERPTShjZWxsKSkpO1xuICB9XG5cbiAgY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgICAkcDJHYW1lYm9hcmQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gIH1cblxuICBpbml0KCk7XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0LFxuICAgIHJlbmRlckdhbWVib2FyZCxcbiAgICBjZWxsSGl0LFxuICAgIHNoaXBTdW5rLFxuICAgIHRvZ2dsZUFjdGl2ZUJvYXJkLFxuICB9O1xuXG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBVSTsiLCJpbXBvcnQgVUkgZnJvbSBcIi4uL01vZHVsZXMvVUlcIjtcblxuY29uc3QgR2FtZWJvYXJkID0gKHNpemUpID0+IHtcblxuICBjb25zdCBzaGlwcyA9IFtdO1xuXG4gIGNvbnN0IGNlbGwgPSAoeCwgeSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBjb29yZHM6IHt4LCB5fSxcbiAgICAgIGhhc1NoaXA6ICcnLFxuICAgICAgaXNTaG90OiBmYWxzZVxuICAgIH07XG4gIH1cblxuICBjb25zdCBfbWFrZUdyaWQgPSAoc2l6ZSkgPT4ge1xuICAgIGNvbnN0IGFyciA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZSAqIHNpemU7IGkrKykge1xuICAgICAgYXJyLnB1c2goY2VsbChpICUgc2l6ZSwgTWF0aC5mbG9vcihpIC8gc2l6ZSkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGFycjtcbiAgfVxuXG4gIGNvbnN0IGJvYXJkID0gX21ha2VHcmlkKHNpemUpO1xuICBjb25zdCBhdCA9IChjb29yZHMpID0+IGJvYXJkW2Nvb3Jkcy54ICsgY29vcmRzLnkgKiBzaXplXTtcblxuICBjb25zdCBpc1ZhbGlkQXR0YWNrID0gKGNvb3JkcykgPT4ge1xuICAgIHJldHVybiAhYXQoY29vcmRzKS5pc1Nob3Q7XG4gIH1cblxuICBjb25zdCBpc1NoaXBIaXQgPSAoY29vcmRzKSA9PiB7XG4gICAgcmV0dXJuIGF0KGNvb3JkcykuaGFzU2hpcCAhPT0gJyc7XG4gIH1cblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvb3JkcykgPT4ge1xuICAgIGNvbnN0IGNlbGwgPSBhdChjb29yZHMpO1xuICAgIGNlbGwuaXNTaG90ID0gdHJ1ZTtcbiAgICBVSS5jZWxsSGl0KGNvb3Jkcyk7XG4gICAgaWYgKGNlbGwuaGFzU2hpcCkge1xuICAgICAgY29uc3Qgc2hpcCA9IHNoaXBzLmZpbmQoc2hpcCA9PiBzaGlwLm5hbWUgPT09IGNlbGwuaGFzU2hpcCk7XG4gICAgICBzaGlwLmhpdCgpO1xuICAgICAgaWYgKHNoaXAuaXNTdW5rKCkpIHNoaXBTdW5rKHNoaXAubmFtZSk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc2V0U2hpcCA9IChzaGlwLCBjb29yZHMsIGF4aXMgPSAneCcpID0+IHtcbiAgICBzaGlwcy5wdXNoKHNoaXApO1xuICAgIGxldCBuZXdDb29yZHMgPSBjb29yZHM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmdldExlbmd0aCgpOyBpKyspIHtcbiAgICAgIGF0KG5ld0Nvb3JkcykuaGFzU2hpcCA9IHNoaXAubmFtZTtcbiAgICAgIGF4aXMgPT09ICd4JyA/IG5ld0Nvb3Jkcy54Kys6IG5ld0Nvb3Jkcy55Kys7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc2hpcFN1bmsgPSAoc2hpcE5hbWUpID0+IHtcbiAgICBjb25zb2xlLmxvZyhzaGlwTmFtZSk7XG4gICAgY29uc3QgY29vcmRzQXJyYXkgPSBib2FyZC5maWx0ZXIoY2VsbCA9PiBjZWxsLmhhc1NoaXAgPT09IHNoaXBOYW1lKS5tYXAoY2VsbCA9PiBjZWxsLmNvb3Jkcyk7XG4gICAgVUkuc2hpcFN1bmsoY29vcmRzQXJyYXkpO1xuICB9XG5cbiAgY29uc3QgZ2V0Qm9hcmQgPSAoKSA9PiBib2FyZDtcblxuICByZXR1cm4ge1xuICAgIGF0LFxuICAgIGlzVmFsaWRBdHRhY2ssXG4gICAgaXNTaGlwSGl0LFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgc2V0U2hpcCxcbiAgICBnZXRCb2FyZCxcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkOyIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vR2FtZWJvYXJkXCJcblxuY29uc3QgUGxheWVyID0gKG5hbWUpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBuYW1lLFxuICAgIGdhbWVib2FyZDogR2FtZWJvYXJkKDEwKSxcbiAgICBpc0FjdGl2ZTogZmFsc2UsXG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBsYXllcjsiLCJjb25zdCBTaGlwID0gKGxlbmd0aCwgbmFtZSkgPT4ge1xuICBjb25zdCBzaGlwTGVuZ3RoID0gbGVuZ3RoO1xuICBsZXQgaGl0Q291bnQgPSAwO1xuXG4gIC8vIEdldHRlcnNcbiAgY29uc3QgZ2V0TGVuZ3RoID0gKCkgPT4gc2hpcExlbmd0aDtcbiAgY29uc3QgZ2V0SGl0cyA9ICgpID0+IGhpdENvdW50O1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBoaXRDb3VudCsrO1xuICB9XG5cbiAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgIHJldHVybiBzaGlwTGVuZ3RoID09PSBoaXRDb3VudDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgbmFtZSxcbiAgICBnZXRMZW5ndGgsXG4gICAgZ2V0SGl0cyxcbiAgICBoaXQsXG4gICAgaXNTdW5rLFxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBTaGlwOyIsImNvbnN0IEFJID0gKCgpID0+IHtcblxuICBjb25zdCBnZXRDb29yZHMgPSAoYm9hcmQpID0+IHtcbiAgICBjb25zdCB2YWxpZENlbGxzID0gYm9hcmQuZmlsdGVyKGNlbGwgPT4gIWNlbGwuaXNTaG90KTtcbiAgICBjb25zdCBjb29yZHMgPSB2YWxpZENlbGxzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHZhbGlkQ2VsbHMubGVuZ3RoKV0uY29vcmRzO1xuICAgIHJldHVybiBjb29yZHM7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRDb29yZHMsXG4gIH07XG5cbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IEFJOyIsImltcG9ydCBQbGF5ZXIgZnJvbSBcIi4uL0ZhY3Rvcmllcy9QbGF5ZXJcIlxuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL0ZhY3Rvcmllcy9TaGlwXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vVUlcIjtcbmltcG9ydCBBSSBmcm9tIFwiLi9BSVBsYXllclwiO1xuaW1wb3J0IFBsYWNlU2hpcHMgZnJvbSBcIi4vUGxhY2VTaGlwc1wiO1xuXG5jb25zdCBHYW1lQ29udHJvbGxlciA9ICgoKSA9PiB7XG5cbiAgY29uc3QgcGxheWVyMSA9IFBsYXllcigncGxheWVyJyk7XG4gIGNvbnN0IHBsYXllcjIgPSBQbGF5ZXIoJ2VuZW15Jyk7XG5cbiAgZnVuY3Rpb24gc2xlZXAobXMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG4gIH0gXG5cbiAgY29uc3Qgb3Bwb25lbnQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHBsYXllcjEuaXNBY3RpdmUgPyBwbGF5ZXIyOiBwbGF5ZXIxO1xuICB9XG5cbiAgY29uc3QgdG9nZ2xlQWN0aXZlUGxheWVyID0gKCkgPT4ge1xuICAgIHBsYXllcjEuaXNBY3RpdmUgPSAhcGxheWVyMS5pc0FjdGl2ZTtcbiAgICBwbGF5ZXIyLmlzQWN0aXZlID0gIXBsYXllcjIuaXNBY3RpdmU7XG4gICAgVUkudG9nZ2xlQWN0aXZlQm9hcmQoKTtcbiAgfVxuXG4gIGNvbnN0IGluaXRQbGF5ZXIxID0gKCkgPT4ge1xuICAgIHBsYXllcjEuaXNBY3RpdmUgPSB0cnVlO1xuICAgIGNvbnN0IHNoaXBJbmZvQXJyYXkgPSBQbGFjZVNoaXBzLmdldFNoaXBJbmZvQXJyYXkoKTtcbiAgICBzaGlwSW5mb0FycmF5LmZvckVhY2goc2hpcEluZm8gPT4ge1xuICAgICAgcGxheWVyMS5nYW1lYm9hcmQuc2V0U2hpcChzaGlwSW5mby5zaGlwLCBzaGlwSW5mby5jb29yZHMsIHNoaXBJbmZvLmF4aXMpO1xuICAgIH0pO1xuICAgIFVJLnJlbmRlckdhbWVib2FyZCgnUDEnLCBwbGF5ZXIxLm5hbWUsIHBsYXllcjEuZ2FtZWJvYXJkLmdldEJvYXJkKCkpO1xuICB9XG5cbiAgY29uc3QgaW5pdFBsYXllcjIgPSAoKSA9PiB7XG4gICAgcGxheWVyMi5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgIGxldCBzaGlwcyA9IFtTaGlwKDMsICdlbmVteWEnKSwgU2hpcCgyLCAnZW5lbXliJyldO1xuICAgIHBsYXllcjIuZ2FtZWJvYXJkLnNldFNoaXAoc2hpcHNbMF0sIHt4OiAxLCB5OiAxfSwgJ3gnKTtcbiAgICBwbGF5ZXIyLmdhbWVib2FyZC5zZXRTaGlwKHNoaXBzWzFdLCB7eDogMiwgeTogNX0sICd5Jyk7XG4gICAgVUkucmVuZGVyR2FtZWJvYXJkKCdQMicsIHBsYXllcjIubmFtZSwgcGxheWVyMi5nYW1lYm9hcmQuZ2V0Qm9hcmQoKSk7XG4gIH1cblxuICBjb25zdCBwbGF5VHVybiA9IChjb29yZHMpID0+IHtcbiAgICBjb25zdCBvcHBvbmVudEJvYXJkID0gb3Bwb25lbnQoKS5nYW1lYm9hcmQ7XG4gICAgaWYgKCFvcHBvbmVudEJvYXJkLmlzVmFsaWRBdHRhY2soY29vcmRzKSkgcmV0dXJuO1xuICAgIG9wcG9uZW50Qm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZHMpO1xuICAgIGlmICghb3Bwb25lbnRCb2FyZC5pc1NoaXBIaXQoY29vcmRzKSkgdG9nZ2xlQWN0aXZlUGxheWVyKCk7XG4gICAgcGxheUdhbWUoKTtcbiAgfVxuXG4gIGNvbnN0IHBsYXlHYW1lID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChwbGF5ZXIyLmlzQWN0aXZlKSB7XG4gICAgICBhd2FpdCBzbGVlcCgzMDApO1xuICAgICAgcGxheVR1cm4oQUkuZ2V0Q29vcmRzKG9wcG9uZW50KCkuZ2FtZWJvYXJkLmdldEJvYXJkKCkpKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBpbml0ID0gKCkgPT4ge1xuICAgIGluaXRQbGF5ZXIxKCk7XG4gICAgaW5pdFBsYXllcjIoKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQsXG4gICAgcGxheVR1cm4sXG4gIH07XG5cbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IEdhbWVDb250cm9sbGVyOyIsImltcG9ydCBHYW1lQ29udHJvbGxlciBmcm9tIFwiLi9HYW1lQ29udHJvbGxlclwiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi4vRmFjdG9yaWVzL1BsYXllclwiO1xuaW1wb3J0IFNoaXAgZnJvbSBcIi4uL0ZhY3Rvcmllcy9TaGlwXCI7XG5cbmNvbnN0IFBsYWNlU2hpcHMgPSAoKCkgPT4ge1xuICBjb25zdCBwbGF5ZXIgPSBQbGF5ZXIoJ3NhbXBsZScpO1xuICBjb25zdCBzaGlwcyA9IFtTaGlwKDQsICdhaycpLCBTaGlwKDIsICdiJyksIFNoaXAoNSwgJ2MnKSwgU2hpcCg0LCAnZCcpLCBTaGlwKDIsICdlJyldO1xuICBsZXQgY3VycmVudCA9IHtcbiAgICBzaGlwTnVtOiAwLFxuICAgIHNoaXBDb29yZHNBcnJheTogW10sXG4gICAgYXhpczogJ3gnXG4gIH07XG4gIGNvbnN0ICRtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpXG4gIGNvbnN0ICRzYW1wbGVHYW1lQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2FtcGxlJyk7XG4gIGNvbnN0IHNoaXBJbmZvQXJyYXkgPSBbXTtcbiAgY29uc3Qgc2hpcEluZm8gPSAoc2hpcCwgY29vcmRzLCBheGlzKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNoaXAsXG4gICAgICBjb29yZHMsXG4gICAgICBheGlzXG4gICAgfTtcbiAgfTtcblxuICBjb25zdCBuZXdDZWxsRE9NID0gKGNlbGwpID0+IHtcbiAgICBjb25zdCAkY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICRjZWxsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcbiAgICAkY2VsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRzJywgYCR7Y2VsbC5jb29yZHMueH0gJHtjZWxsLmNvb3Jkcy55fWApO1xuICAgIGFkZENlbGxMaXN0ZW5lcigkY2VsbCk7XG4gICAgcmV0dXJuICRjZWxsO1xufVxuXG5jb25zdCBhZGRDZWxsTGlzdGVuZXIgPSAoJGNlbGwpID0+IHtcbiAgJGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY29uc3QgY29vcmRzQXJyYXkgPSAkY2VsbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRzJykuc3BsaXQoJyAnKTtcbiAgICBjb25zdCBjb29yZHMgPSB7eDogK2Nvb3Jkc0FycmF5WzBdLCB5OiArY29vcmRzQXJyYXlbMV19O1xuICAgIHBsYWNlU2hpcChjb29yZHMsIGN1cnJlbnQuYXhpcyk7XG4gIH0pO1xuXG4gICRjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcbiAgICBjb25zdCBjb29yZHNBcnJheSA9ICRjZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1jb29yZHMnKS5zcGxpdCgnICcpO1xuICAgIGNvbnN0IGNvb3JkcyA9IHt4OiArY29vcmRzQXJyYXlbMF0sIHk6ICtjb29yZHNBcnJheVsxXX07XG4gICAgc2hvd1NoaXAoY29vcmRzLCBjdXJyZW50LmF4aXMpO1xuICB9KTtcbn1cblxuLy8gY29uc3QgY2VsbEF0ID0gKGNvb3JkcykgPT4ge1xuLy8gICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtY29vcmRzPVwiJHtjb29yZHMueH0gJHtjb29yZHMueX1cIl1gKTtcbi8vIH1cblxuY29uc3Qgc2hvd1NoaXAgPSAoY29vcmRzLCBheGlzKSA9PiB7XG4gIGlmIChjdXJyZW50LnNoaXBDb29yZHNBcnJheS5sZW5ndGggIT09IDApIHtcbiAgICBjdXJyZW50LnNoaXBDb29yZHNBcnJheS5mb3JFYWNoKGNvb3JkcyA9PiB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYm9hcmQgPiBbZGF0YS1jb29yZHM9XCIke2Nvb3Jkcy54fSAke2Nvb3Jkcy55fVwiXWApLmNsYXNzTGlzdC5yZW1vdmUoJ3RlbXAnKTtcbiAgICB9KVxuICB9XG4gIGN1cnJlbnQuc2hpcENvb3Jkc0FycmF5ID0gW107XG4gIGxldCBuZXdDb29yZHMgPSBjb29yZHM7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcHNbY3VycmVudC5zaGlwTnVtXS5nZXRMZW5ndGgoKTsgaSsrKSB7XG4gICAgY3VycmVudC5zaGlwQ29vcmRzQXJyYXkucHVzaCh7eDogbmV3Q29vcmRzLngsIHk6IG5ld0Nvb3Jkcy55fSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmJvYXJkID4gW2RhdGEtY29vcmRzPVwiJHtuZXdDb29yZHMueH0gJHtuZXdDb29yZHMueX1cIl1gKS5jbGFzc0xpc3QuYWRkKCd0ZW1wJyk7XG4gICAgYXhpcyA9PT0gJ3gnID8gbmV3Q29vcmRzLngrKzogbmV3Q29vcmRzLnkrKztcbiAgICBpZiAobmV3Q29vcmRzLnggPiA5IHx8IG5ld0Nvb3Jkcy55ID4gOSkgYnJlYWs7XG4gIH1cbn1cblxuY29uc3QgcmVuZGVyR2FtZWJvYXJkID0gKHBsYXllciwgcGxheWVyTmFtZSwgYm9hcmQpID0+IHtcbiAgbGV0ICRib2FyZCA9ICRzYW1wbGVHYW1lQm9hcmQ7XG4gICRib2FyZC5jbGFzc0xpc3QuYWRkKHBsYXllck5hbWUpO1xuICBib2FyZC5mb3JFYWNoKGNlbGwgPT4gJGJvYXJkLmFwcGVuZENoaWxkKG5ld0NlbGxET00oY2VsbCkpKTtcbn1cblxuICBjb25zdCBwbGFjZVNoaXAgPSAoY29vcmRzLCBheGlzKSA9PiB7XG4gICAgc2hpcEluZm9BcnJheS5wdXNoKHNoaXBJbmZvKHNoaXBzW2N1cnJlbnQuc2hpcE51bSsrXSwgY29vcmRzLCBheGlzKSk7XG4gICAgY3VycmVudC5zaGlwQ29vcmRzQXJyYXkuZm9yRWFjaChjb29yZHMgPT4ge1xuICAgICAgY29uc3QgJGNlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYm9hcmQgPiBbZGF0YS1jb29yZHM9XCIke2Nvb3Jkcy54fSAke2Nvb3Jkcy55fVwiXWApXG4gICAgICAkY2VsbC5jbGFzc0xpc3QuYWRkKCdzaGlwJyk7XG4gICAgICAkY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCd0ZW1wJyk7XG4gICAgfSlcbiAgICBpZiAoc2hpcEluZm9BcnJheS5sZW5ndGggPT09IHNoaXBzLmxlbmd0aCkge1xuICAgICAgJG1vZGFsLnJlbW92ZSgpO1xuICAgICAgR2FtZUNvbnRyb2xsZXIuaW5pdCgpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGdldFNoaXBJbmZvQXJyYXkgPSAoKSA9PiBzaGlwSW5mb0FycmF5O1xuXG4gIGNvbnN0IGluaXQgPSAoKSA9PiB7XG4gICAgcmVuZGVyR2FtZWJvYXJkKCdzYW1wbGUnLCBwbGF5ZXIubmFtZSwgcGxheWVyLmdhbWVib2FyZC5nZXRCb2FyZCgpKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICh7IGtleSB9KSA9PiB7XG4gICAgICBpZiAoa2V5ID09PSAnUicgfHwga2V5ID09PSAncicpIHtcbiAgICAgICAgY3VycmVudC5heGlzID0gY3VycmVudC5heGlzID09PSAneCcgPyAneSc6ICd4JztcbiAgICAgICAgc2hvd1NoaXAoY3VycmVudC5zaGlwQ29vcmRzQXJyYXlbMF0sIGN1cnJlbnQuYXhpcyk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW5pdCxcbiAgICBnZXRTaGlwSW5mb0FycmF5LFxuICB9XG5cbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IFBsYWNlU2hpcHM7IiwiLy8gaW1wb3J0IEdhbWVDb250cm9sbGVyIGZyb20gXCIuL01vZHVsZXMvR2FtZUNvbnRyb2xsZXJcIjtcbmltcG9ydCBQbGFjZVNoaXBzIGZyb20gXCIuL01vZHVsZXMvUGxhY2VTaGlwc1wiO1xuXG5QbGFjZVNoaXBzLmluaXQoKTsiXSwibmFtZXMiOlsiJHAxR2FtZWJvYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiJHAyR2FtZWJvYXJkIiwiaW5pdCIsImNsYXNzTGlzdCIsImFkZCIsInJlbmRlckdhbWVib2FyZCIsInBsYXllciIsInBsYXllck5hbWUiLCJib2FyZCIsIiRib2FyZCIsImZvckVhY2giLCJjZWxsIiwiYXBwZW5kQ2hpbGQiLCIkY2VsbCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjb29yZHMiLCJ4IiwieSIsImhhc1NoaXAiLCJhZGRFdmVudExpc3RlbmVyIiwiY29vcmRzQXJyYXkiLCJnZXRBdHRyaWJ1dGUiLCJzcGxpdCIsImFkZENlbGxMaXN0ZW5lciIsIm5ld0NlbGxET00iLCJjZWxsSGl0IiwiZW5jb2RlZENvb3JkcyIsInNoaXBTdW5rIiwidG9nZ2xlQWN0aXZlQm9hcmQiLCJ0b2dnbGUiLCJzaXplIiwic2hpcHMiLCJhcnIiLCJpIiwicHVzaCIsIk1hdGgiLCJmbG9vciIsImlzU2hvdCIsIl9tYWtlR3JpZCIsImF0IiwiaXNWYWxpZEF0dGFjayIsImlzU2hpcEhpdCIsInJlY2VpdmVBdHRhY2siLCJzaGlwIiwiZmluZCIsIm5hbWUiLCJoaXQiLCJpc1N1bmsiLCJzaGlwTmFtZSIsImNvbnNvbGUiLCJsb2ciLCJmaWx0ZXIiLCJtYXAiLCJzZXRTaGlwIiwiYXhpcyIsIm5ld0Nvb3JkcyIsImdldExlbmd0aCIsImdldEJvYXJkIiwiZ2FtZWJvYXJkIiwiaXNBY3RpdmUiLCJsZW5ndGgiLCJzaGlwTGVuZ3RoIiwiaGl0Q291bnQiLCJnZXRIaXRzIiwidmFsaWRDZWxscyIsInJhbmRvbSIsInBsYXllcjEiLCJwbGF5ZXIyIiwib3Bwb25lbnQiLCJwbGF5VHVybiIsIm9wcG9uZW50Qm9hcmQiLCJwbGF5R2FtZSIsImFzeW5jIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2hpcEluZm8iLCJpbml0UGxheWVyMiIsImN1cnJlbnQiLCJzaGlwTnVtIiwic2hpcENvb3Jkc0FycmF5IiwiJG1vZGFsIiwiJHNhbXBsZUdhbWVCb2FyZCIsInNoaXBJbmZvQXJyYXkiLCJzaG93U2hpcCIsInJlbW92ZSIsInBsYWNlU2hpcCIsImtleSIsImdldFNoaXBJbmZvQXJyYXkiXSwic291cmNlUm9vdCI6IiJ9